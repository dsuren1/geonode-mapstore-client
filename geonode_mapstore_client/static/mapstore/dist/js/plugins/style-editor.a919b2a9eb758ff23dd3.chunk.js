(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[91701],{501157:(e,t,r)=>{"use strict";r.d(t,{en:()=>C,FU:()=>q,gs:()=>A,tt:()=>G,jY:()=>W,QQ:()=>$,B8:()=>k,T6:()=>U,ZP:()=>I});var n=r(472500),o=r.n(n),i=r(701469),a=r.n(i),l=r(984596),u=r.n(l),s=r(227361),c=r.n(s),p=r(441609),f=r.n(p),y=r(264721),d=r.n(y),m=r(944908),g=r.n(m),b=r(727418),v=r.n(b),h=r(505055),S=r.n(h),O=r(375875),w=r.n(O),L=r(737275),x=r(986267),P=r(396606);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===j(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B={},C=function(e){var t=(a()(e)&&e||e.split(","))[0],r=o().parse(t,!0);return o().format(v()({},r,{search:null},{query:v()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},r.query)}))},T=function(e){var t=e&&e.Title,r=e.LogoURL&&E(E({},c()(e,"LogoURL.$")||{}),{},{format:c()(e,"LogoURL.Format")}),n=c()(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:r,imageUrl:c()(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:n}},M=function e(t){return t.Layer?(a()(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,r){return t.concat(e(r)).concat(r.Layer&&r.Name?[r]:[])}),[]):t.Name&&[t]||[]},D=function(){var e,t,r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,s=(o.WMS_Capabilities||o.WMT_MS_Capabilities||{}).Capability,c=(o.WMS_Capabilities||o.WMT_MS_Capabilities||{}).Service,p=(n=s).Request&&n.Request.GetMap&&n.Request.GetMap.DCPType&&n.Request.GetMap.DCPType.HTTP&&n.Request.GetMap.DCPType.HTTP.Get&&n.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&n.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0,f=s.Layer&&(null===(e=s.Layer.SRS||s.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],y=s.Layer&&s.Layer.Attribution&&T(s.Layer.Attribution),d=s.Request&&s.Request.GetMap&&s.Request.GetMap.Format||[],m=M(s),g=(a()(m)?m:[m]).filter((function(e){return!u||-1!==e.Name.toLowerCase().indexOf(u.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(u.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(u.toLowerCase())}));return{numberOfRecordsMatched:g.length,numberOfRecordsReturned:Math.min(l,g.length),nextRecord:i+Math.min(l,g.length)+1,service:c,layerOptions:{version:(null===(t=o.WMS_Capabilities||o.WMT_MS_Capabilities)||void 0===t||null===(r=t.$)||void 0===r?void 0:r.version)||"1.3.0"},records:g.filter((function(e,t){return t>=i-1&&t<i-1+l})).map((function(e){return v()({},e,{formats:d,onlineResource:p,SRS:f,credits:e.Attribution?T(e.Attribution):y})}))}},q=function(e,t){var n=o().parse(e,!0),i=o().format(v()({},n,{query:v()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},n.query)}));return new Promise((function(e){Promise.all([r.e(99942),r.e(67260)]).then(function(){var n=r(967260).unmarshaller;e(w().get(C(i)).then((function(e){var r;if(t)return S().parseString(e.data,{explicitArray:!1},(function(e,t){r=t})),r;var o=n.unmarshalString(e.data);return o&&o.value})))}.bind(null,r)).catch(r.oe)}))},_=function(e,t,r,n){var o=B[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,L.u8)("cacheExpire")||60)?new Promise((function(e){e(D(o.data,t,r,n))})):w().get(C(e)).then((function(o){var i;return S().parseString(o.data,{explicitArray:!1},(function(e,t){i=t})),B[e]={timestamp:(new Date).getTime(),data:i},D(i,t,r,n)}))},A=function(e,t){var r=o().parse(e,!0),n=o().format(v()({},r,{query:v()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},r.query)}));return w().get(C(n)).then((function(e){var t;return S().parseString(e.data,{explicitArray:!1},(function(e,r){t=r&&r.WMS_DescribeLayerResponse&&r.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return E(E({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:E({},e&&e.query&&e.query.$||{})})}))}))},G=function(e,t,r,n){return _(e,t,r,n)},W=function(e,t){for(var r=e,n=r.EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,x.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;!n&&r.Layer&&r.Layer.length;)n=(r=r.Layer[0]).EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,x.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;n||(n={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var o={extent:[n.westBoundLongitude||n.minx,n.southBoundLatitude||n.miny,n.eastBoundLongitude||n.maxx,n.northBoundLatitude||n.maxy],crs:"EPSG:4326"};return t?{crs:o.crs,bounds:{minx:o.extent[0],miny:o.extent[1],maxx:o.extent[2],maxy:o.extent[3]}}:o},$=[{label:"image/png",value:"image/png"},{label:"image/png8",value:"image/png8"},{label:"image/jpeg",value:"image/jpeg"},{label:"image/vnd.jpeg-png",value:"image/vnd.jpeg-png"},{label:"image/vnd.jpeg-png8",value:"image/vnd.jpeg-png8"},{label:"image/gif",value:"image/gif"}],k=function(){return g()(Object.values((0,P.eq)()))},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return q(e).then((function(e){var r,n,o=c()(e,"capability.request.getMap.format",[]);if(f()(o))r=$;else{var i=$.map((function(e){return e.value}));r=(o=o.map((function(e){var t=e.value;return{label:t,value:t}}))).filter((function(e){var t=e.value;return d()(i,t)}))||[]}if(t){var a=c()(e,"capability.request.getFeatureInfo.format",[]),l=k();f()(a)?n=l:(a=a.map((function(e){return e.value})),n=g()(a.filter((function(e){return d()(l,e)})))||[])}return t?{imageFormats:r,infoFormats:n}:r})).catch((function(){return t?{imageFormats:$,infoFormats:k()}:$}))};const I={flatLayers:M,parseUrl:C,getDimensions:function(e){return u()(e.Dimension||e.dimension||[]).map((function(t,r){var n=e.Extent&&u()(e.Extent)[r]||e.extent&&u()(e.extent)[r];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||n&&n.$.default,values:t._&&t.split(",")||n&&n._&&n.split(",")}}))},getCapabilities:q,describeLayer:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o().parse(e,!0),a=o().format(v()({},i,{query:v()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},i.query,n.query||{})}));return new Promise((function(e){Promise.all([r.e(99942),r.e(67260)]).then(function(){var t=r(967260).unmarshaller;e(w().get(C(a)).then((function(e){var r=t.unmarshalString(e.data);return r&&r.value&&r.value.layerDescription&&r.value.layerDescription[0]})))}.bind(null,r)).catch(r.oe)}))},getRecords:_,describeLayers:A,textSearch:G,parseLayerCapabilities:function e(t,r,n){return u()(n||c()(t,"capability.layer.layer")).reduce((function(n,o){return n||(!o.name&&o.layer?e(t,r,u()(o.layer)):2===r.name.split(":").length&&o.name&&2===o.name.split(":").length?r.name===o.name&&o:o.name&&2===o.name.split(":").length?r.name===o.name.split(":")[1]&&o:2===r.name.split(":").length?r.name.split(":")[1]===o.name&&o:r.name===o.name&&o)}),null)},getBBox:W,reset:function(){Object.keys(B).forEach((function(e){delete B[e]}))},getUniqueInfoFormats:k,getSupportedFormat:U}},398592:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>G});var n=r(701469),o=r.n(n),i=r(747037),a=r.n(i),l=r(727418),u=r.n(l),s=r(675263),c=r.n(s),p=r(124852),f=r.n(p),y=r(171703),d=r(867076),m=r(22222),g=r(580416),b=r(396909),v=r(615402),h=r(965539),S=r(982030),O=r(173014),w=r(532425),L=r(274621),x=r(893222),P=r(99009),j=r(278720);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function D(e,t,r){return(t=q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===R(t)?t:String(t)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(u,e);var t,r,n,i,l=(n=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(n);if(i){var r=M(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),l.apply(this,arguments)}return t=u,(r=[{key:"UNSAFE_componentWillMount",value:function(){var e=!this.props.editingAllowedRoles||o()(this.props.editingAllowedRoles)&&a()(this.props.userRole)&&-1!==this.props.editingAllowedRoles.indexOf(this.props.userRole);this.props.onInit(this.props.styleService,e&&(0,P.uW)(this.props.layer,this.props.styleService))}},{key:"render",value:function(){return f().createElement(h.Z,{className:"ms-style-editor-container",header:this.props.showToolbar?f().createElement("div",{className:"ms-style-editor-container-header"},this.props.header,f().createElement("div",{className:"text-center"},f().createElement(j.lC,{enableSetDefaultStyle:this.props.enableSetDefaultStyle}))):null,footer:f().createElement("div",{style:{height:25}})},this.props.isEditing?f().createElement(j.m2,{config:this.props.editorConfig}):f().createElement(j.tM,{showDefaultStyleIcon:this.props.canEdit&&this.props.enableSetDefaultStyle}))}}])&&C(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(f().Component);D(_,"propTypes",{layer:c().object,header:c().node,isEditing:c().bool,showToolbar:c().node.bool,onInit:c().func,styleService:c().object,userRole:c().string,editingAllowedRoles:c().array,enableSetDefaultStyle:c().bool,canEdit:c().bool,editorConfig:c().object}),D(_,"defaultProps",{layer:{},onInit:function(){},editingAllowedRoles:["ADMIN"],editorConfig:{}});var A=(0,d.compose)(d.toClass,(0,d.branch)((function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).active}),(function(){return function(){return null}})),(0,y.connect)((0,m.P1)([x.ex,x.aN,x.Vf,x.p,L.L3,x.z_,x.Z0],(function(e,t,r,n,o,i,a){return{isEditing:"edit"===e,loading:t,layer:r,error:n,userRole:o,canEdit:i,styleService:a}})),{onInit:b.E0,onUpdateParams:g.Xy},(function(e,t,r){var n,o,i,a=(null===(n=r.styleService)||void 0===n?void 0:n.baseUrl)===(null===(o=e.styleService)||void 0===o?void 0:o.baseUrl)&&(null===(i=e.styleService)||void 0===i?void 0:i.isStatic),l=r.styleService&&!a?B(B({},r.styleService),{},{isStatic:!0}):B({},e.styleService);return B(B(B(B({},r),e),t),{},{styleService:l})})),(0,S.Z)((function(e){var t=e.error;return!!(null!=t&&t.availableStyles||null!=t&&t.global||null!=t&&t.parsingCapabilities)}),(function(e){var t=e.error;return{glyph:"exclamation-mark",title:f().createElement(v.Z,{msgId:"styleeditor.errorTitle"}),description:f().createElement(v.Z,{msgId:((null==t?void 0:t.availableStyles)?"styleeditor.missingAvailableStylesMessage":(null==t?void 0:t.parsingCapabilities)&&"styleeditor.parsingCapabilitiesError")||(null==t?void 0:t.global)&&"styleeditor.globalError"}),style:{display:"flex",width:"100%",height:"100%",overflow:"hidden"},mainViewStyle:{margin:"auto",width:300}}})),(0,O.Z)((function(e){return"global"===e.loading}),{size:150,style:{margin:"auto"}},(function(e){return f().createElement("div",{style:{position:"relative",height:"100%",display:"flex"}},f().createElement(w.Z,e))})),(0,d.compose)((0,y.connect)((function(){return{}}),{toggleStyleEditor:b.Wv}),(0,d.lifecycle)({componentDidMount:function(){this.props.toggleStyleEditor(null,!0)}})))(_);const G={StyleEditorPlugin:u()(A,{TOC:{priority:1,container:"TOCItemSettings"},TOCItemsSettings:{name:"StyleEditor",target:"style",priority:1,ToolbarComponent:j.lC}}),reducers:{styleeditor:r(532244).Z},epics:r(394943).ZP}}}]);